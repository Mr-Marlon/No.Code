<!DOCTYPE html>
<html lang="zh-TW">
<head>
    <meta charset="utf-8">
    <link rel="shortcut icon" href="favicon.ico" type="image/x-icon">
    <title>抽奖池 - 机器人俱乐部</title>
    <link rel="stylesheet" href="css/style.css">
</head>
<body>
    <header>
        <h1 onclick="location.href='index.html'" style="cursor:pointer">机器人俱乐部</h1>
        <nav>
            <ul>
                <li><a href="score.html">对抗赛计分</a></li>
                <li><a href="lottery.html" style="color: red;">抽奖池</a></li>
                <li><a href="vs-rules.html">对抗赛规则</a></li>
                <li><a href="task-rules.html">任务赛规则</a></li>
                <li><a href="staff.html">人员安排</a></li>
            </ul>
        </nav>
    </header>
    
    <main>
        <section class="main"></section>  
        <div class="lottery-container">
            <div class="cards-stack">
                <div class="card" data-number="1" style="--color: #FF6B6B;">
                    <div class="card-front">1</div>
                    <div class="card-back"></div>
                </div>
                <div class="card" data-number="2" style="--color: #4ECDC4;">
                    <div class="card-front">2</div>
                    <div class="card-back"></div>
                </div>
                <div class="card" data-number="3" style="--color: #FFD166;">
                    <div class="card-front">3</div>
                    <div class="card-back"></div>
                </div>
                <div class="card" data-number="4" style="--color: #06D6A0;">
                    <div class="card-front">4</div>
                    <div class="card-back"></div>
                </div>
                <div class="card" data-number="5" style="--color: #118AB2;">
                    <div class="card-front">5</div>
                    <div class="card-back"></div>
                </div>
                <div class="card" data-number="6" style="--color: #9D4EDD;">
                    <div class="card-front">6</div>
                    <div class="card-back"></div>
                </div>
                <div class="card" data-number="7" style="--color: #F15BB5;">
                    <div class="card-front">7</div>
                    <div class="card-back"></div>
                </div>
                <div class="card" data-number="8" style="--color: #00BBF9;">
                    <div class="card-front">8</div>
                    <div class="card-back"></div>
                </div>
            </div>
            
            <div class="result" id="result"></div>
			<div class="result-image" id="result-image">
			        <img src="img/奖品.png" alt="奖品">
			    </div>
        </div>
    </main>
    
    <footer>
        <strong><p>Copyright © 2025 马宇诚 - 机器人俱乐部 版权所有</p></strong>
    </footer>
    
    <script>
        (function() {
            const cardBacks = document.querySelectorAll('.card-back');
            
            cardBacks.forEach(back => {
                const rand = Math.random();
                
                if (rand < 0.25) {
                    back.textContent = '一等奖';     
                } else if (rand < 0.55) {           
                    back.textContent = '二等奖';    
                } else if (rand < 0.95) {           
                    back.textContent = '三等奖';     
                } else {                           
                    back.textContent = '幸运奖';      
                }
            });
            
            const allAwards = Array.from(cardBacks).map(b => b.textContent);
            const count1 = allAwards.filter(a => a === '一等奖').length;
            const count2 = allAwards.filter(a => a === '二等奖').length;
            const count3 = allAwards.filter(a => a === '三等奖').length;
            const count4 = allAwards.filter(a => a === '幸运奖').length;
            console.log(`奖项分配：一等奖${count1}个，二等奖${count2}个，三等奖${count3}个，幸运奖${count4}个`);
        })();
        
        const cards = document.querySelectorAll('.card');
        const resultEl = document.getElementById('result');
        let isAnimating = false; 
        document.querySelector('.cards-stack').addEventListener('mouseenter', () => {
            if (isAnimating) return;
            
            cards.forEach((card, index) => {
                const totalCards = cards.length;
                const maxAngle = 80; 
                const radius = 500;
                const angle = (index - (totalCards-1)/2) * (maxAngle/(totalCards-1));
                const radian = angle * Math.PI / 180;
                
                const x = Math.sin(radian) * radius;
                const y = -Math.cos(radian) * radius * 0.3; 
                
                card.style.transform = `translateX(${x}px) translateY(${y}px) rotate(${angle}deg)`;
                card.style.zIndex = index + 2;
                card.style.transition = 'transform 0.5s cubic-bezier(0.34, 1.56, 0.64, 1)';
            });
        });
        
        document.querySelector('.cards-stack').addEventListener('mouseleave', () => {
            if (isAnimating) return;
            
            cards.forEach(card => {
                card.style.transform = 'translateX(0) translateY(0) rotate(0)';
                card.style.zIndex = '1';
                card.style.transition = 'transform 0.4s ease';
            });
        });
        
        cards.forEach(card => {
            card.addEventListener('click', async function() {
                if (isAnimating) return;
                isAnimating = true;
                
                cards.forEach(c => c.style.pointerEvents = 'none');
                
                const cardIndex = Array.from(cards).indexOf(this);
                const totalCards = cards.length;
                const maxAngle = 45;
                const angle = (cardIndex - (totalCards-1)/2) * (maxAngle/(totalCards-1));
                const radian = angle * Math.PI / 180;
                const radius = 500;
                const x = Math.sin(radian) * radius;
                const y = -Math.cos(radian) * radius * 0.3;
                
                this.style.transform = `translateX(${x}px) translateY(${y-180}px) rotate(${angle}deg)`;
                this.style.zIndex = '200';
                this.style.transition = 'transform 0.4s ease';
                await sleep(400);
                
                this.style.position = 'fixed';
                this.style.left = '20%';
                this.style.top = '80%';
                this.style.transform = 'translate(-50%, -50%) scale(2.2) rotateY(0deg)';
                this.style.zIndex = '250';
                this.style.boxShadow = '0 25px 60px rgba(0,0,0,0.6)';
                this.style.transition = 'all 0.6s cubic-bezier(0.34, 1.56, 0.64, 1)';
                await sleep(600);
                
                this.style.transform = 'translate(-50%, -50%) scale(2.2) rotateY(180deg)';
                this.style.transition = 'transform 0.8s ease';
                await sleep(800);
                
                cards.forEach(c => {
                    if(c !== this) {
                        c.style.opacity = '0';
                        c.style.transform = 'translateX(0) scale(0.8)';
                        c.style.transition = 'all 0.5s ease';
                    }
                });
                
                const award = this.querySelector('.card-back').textContent;
                resultEl.textContent = `恭喜抽中：${award}`;
                resultEl.style.opacity = '0';
                resultEl.style.transform = 'translate(-50%, -50%) scale(0.8)';
                resultEl.style.transition = 'all 0.3s ease';
                
                await sleep(300);
                resultEl.style.opacity = '1';
                resultEl.style.transform = 'translate(-50%, -50%) scale(1)';
                resultEl.style.transition = 'all 0.5s cubic-bezier(0.34, 1.56, 0.64, 1)';
                
				document.getElementById('result-image').style.opacity = '1';
				document.getElementById('result-image').style.transform = 'translate(-50%, -50%) scale(1)';
				
                setTimeout(async () => {
                    resultEl.style.opacity = '0';
                    resultEl.style.transform = 'translate(-50%, -50%) scale(0.8)';
                    resultEl.style.transition = 'all 0.5s ease';
					document.getElementById('result-image').style.opacity = '0';
					document.getElementById('result-image').style.transform = 'translate(-50%, -50%) scale(0.8)';
                    await sleep(500);
                    
                    this.style.transform = 'translate(-50%, -50%) scale(2.2) rotateY(0deg)';
                    this.style.transition = 'transform 0.6s ease';
                    await sleep(600);
                    
                    this.style.left = '50%';
                    this.style.top = '50%';
                    this.style.marginLeft = '-75px';
                    this.style.marginTop = '-110px';
                    this.style.transform = 'translateX(0) translateY(0) rotate(0)';
                    this.style.zIndex = '1';
                    this.style.boxShadow = '0 10px 20px rgba(0,0,0,0.3)';
                    this.style.transition = 'all 0.8s cubic-bezier(0.34, 1.56, 0.64, 1)';
                    
                    await sleep(800);
                    
                    cards.forEach(c => {
                        c.style.opacity = '1';
                        c.style.transform = 'translateX(0) translateY(0) rotate(0)';
                        c.style.transition = 'all 0.5s ease';
                    });
                    
                    await sleep(500);
                    
                    cards.forEach(c => c.style.pointerEvents = 'auto');
                    isAnimating = false;
                    
                }, 5000);
                
            });
        });
    
        function sleep(ms) {
            return new Promise(resolve => setTimeout(resolve, ms));
        }
		
		document.addEventListener('keypress', function(e) {
		    if (e.key === 'Enter') {
		        login();
		    }
		});
		
		document.addEventListener('contextmenu', function(e) {
		  e.preventDefault();
		});
		
		document.addEventListener('keydown', function(e) {
		  if (
		    e.key === 'F12' ||
		    (e.ctrlKey && e.shiftKey && e.key === 'I') ||
		    (e.ctrlKey && e.shiftKey && e.key === 'J') ||
		    (e.ctrlKey && e.key === 'U') ||
		    (e.keyCode === 123)
		  ) {
		    e.preventDefault();
		  }
		});
    </script>
</body>
</html>